<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no"/>
    <title>EGO漫画</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="js/module/util.js"></script>
    <script src="js/module/tab.js"></script>
    <script src="js/module/search.js"></script>
    <script src="js/module/slider.js"></script>
</head>
<body>
    <header>
        <!-- 顶栏区 -->
        <div class="g-header">
            <div class="m-logo"></div>
            <!-- 将m-tab模板渲染到m-tabs里面 -->
            <div class="m-tabs"></div>
            <div class="m-search"></div>
            <div class="m-login">
                <i class="u-login-logo"></i>
                <span>登录</span>
            </div>
            <div class="m-register">
                <span>注册</span>
            </div>
        </div>
        <!-- 轮播图 -->
        <div class="g-banner">
            <!-- g-banner 轮播区域 -->
            <!-- 轮播组件 m-slider 及对应的 圆点指示器 m-cursor-->
            <ul class="m-cursor f-cb">
                <li class='cursor'></li>
                <li class='cursor'></li>
                <li class='cursor'></li>
            </ul>
            <div class="arrow" id="prev"><</div>
            <div class="arrow" id="next">></div>
        </div>
    </header>

    <!-- 内容区 -->
    <content>
        <div class="g-body f-cb">
            <!-- 主栏 -->
            <div class="g-main"></div>
            <!-- 侧边栏 -->
            <div class="g-side"></div>
        </div>
    </content>

    <!-- 底部区 -->
    <footer>
        <div class="g-footer f-cb"></div>
        <!-- 友情链接 -->

        <!-- 关于我们 -->
    </footer>

    <script>
        var tab = new Tabs();
        tab.init();
    </script>
    <script>
        var search = new Search();
        search.init();
    </script>
    <script>
        var cursors = document.querySelectorAll('.m-cursor .cursor');
        var prev = document.querySelectorAll('.g-banner #prev')[0];
        var next = document.querySelectorAll('.g-banner #next')[0];

        var slider = new Slider({
            //视口容器
            container: document.querySelector('.g-banner'),
            // 是否允许拖拽
            drag: true,
            // 是否自动轮播
            auto: true
        });

        cursors.forEach(function(cursor, index){
            cursor.addEventListener('click', function(){
                slider.nav(index);
            })
        });

        prev.addEventListener('click', function(){
            slider.prev();
        });
        next.addEventListener('click', function(){
            slider.next();
        });

        // 每次slider图片位置变化，cursor也变化，增加监听处理
        slider.on('nav', function( ev ){
            var pageIndex = ev.pageIndex;
            cursors.forEach(function(cursor, index){
                if(index === pageIndex ){
                    cursor.className = 'z-active';
                    cursor.style.backgroundColor = '#5ed0ba';
                }else{
                    cursor.className = '';
                    cursor.style.backgroundColor = '#dedfdf';
                }
            })
        });
        // 从当前页开始轮播
        slider.nav(3);

    </script>
</body>
</html>